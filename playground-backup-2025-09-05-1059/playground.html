<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BI Architecture Playground</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="playground-container">
        <!-- Header -->
        <header class="playground-header">
            <div class="header-content">
                <div class="app-logo">
                    <i class="fas fa-project-diagram"></i>
                    <h1>BI Architecture Playground</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-icon theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
                        <i class="fas fa-moon" id="theme-icon"></i>
                    </button>
                    <button class="btn btn-secondary" onclick="loadCanvas()" title="Load saved canvas">
                        <i class="fas fa-folder-open"></i> Load
                    </button>
                    <button class="btn btn-secondary" onclick="saveCanvas()" title="Save canvas">
                        <i class="fas fa-save"></i> Save
                    </button>
                    <button class="btn btn-secondary" onclick="clearCanvas()">
                        <i class="fas fa-trash"></i> Clear Canvas
                    </button>
                    <button class="btn btn-primary" onclick="exportCanvas()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Fabric Workspace -->
        <div class="fabric-workspace">
            <!-- Fabric Header -->
            <div class="fabric-workspace-header">
                <div class="workspace-title">
                    <i class="fas fa-project-diagram"></i>
                    <h2>Architecture Tool</h2>
                    <!-- workspace-actions removed per request -->
                </div>
            </div>

            <!-- Fabric Toolbar -->
            <div class="fabric-toolbar">
                <div class="toolbar-left">
                    <button class="connection-toggle" id="edit-toggle-btn">
                        <i class="fas fa-pen"></i>
                        <span>Edit Mode</span>
                    </button>
                    <button class="toolbar-btn" onclick="playground.undo()" title="Undo (Ctrl+Z)">
                        <i class="fas fa-undo"></i>
                        <span>Undo</span>
                    </button>
                    <button class="toolbar-btn" onclick="playground.redo()" title="Redo (Ctrl+Y)">
                        <i class="fas fa-redo"></i>
                        <span>Redo</span>
                    </button>
                </div>
                <div class="toolbar-right"><!-- empty on purpose --></div>
            </div>

            <!-- Palette of items above the canvas -->
            <div class="item-palette" id="item-palette">
                <!-- Data Sources - Database Selector Button (moved to first position) -->
                <div class="palette-item database-selector-btn" data-type="database-selector" title="Add Databases">
                    <i class="fas fa-database"></i><span>Databases</span>
                </div>

                <div class="palette-item" draggable="true" data-type="notebook" title="Notebook"><i class="fas fa-book"></i><span>Notebook</span></div>
                <div class="palette-item" draggable="true" data-type="pipeline" title="Data Pipeline"><i class="fas fa-arrows-rotate"></i><span>Data Pipeline</span></div>
                <div class="palette-item" draggable="true" data-type="dataset" title="Dataset"><i class="fas fa-table"></i><span>Dataset</span></div>
                <div class="palette-item" draggable="true" data-type="dataflow" title="Dataflow"><i class="fas fa-diagram-project"></i><span>Dataflow</span></div>
                <div class="palette-item" draggable="true" data-type="report" title="Report"><i class="fas fa-chart-line"></i><span>Report</span></div>
                <div class="palette-item" draggable="true" data-type="dashboard" title="Dashboard"><i class="fas fa-gauge-high"></i><span>Dashboard</span></div>
                <div class="palette-item" draggable="true" data-type="semantic-model" title="Semantic Model"><i class="fas fa-cubes"></i><span>Semantic Model</span></div>
                <div class="palette-item" draggable="true" data-type="warehouse" title="Warehouse"><i class="fas fa-warehouse"></i><span>Warehouse</span></div>
                <div class="palette-item" draggable="true" data-type="lakehouse" title="Lakehouse"><i class="fas fa-water"></i><span>Lakehouse</span></div>

                <!-- Medallion cards as draggable items -->
                <div class="palette-item" draggable="true" data-type="bronze" title="Bronze"><i class="fas fa-award"></i><span>Bronze</span></div>
                <div class="palette-item" draggable="true" data-type="silver" title="Silver"><i class="fas fa-award"></i><span>Silver</span></div>
                <div class="palette-item" draggable="true" data-type="gold" title="Gold"><i class="fas fa-award"></i><span>Gold</span></div>

                <!-- Consumption items moved from right panel into palette -->
                <div class="palette-item" draggable="true"
                     data-consumption-type="powerbi" data-name="Power BI" data-category="Analytics"
                     data-icon="fas fa-chart-bar" data-icon-color="#F2C811" title="Power BI">
                    <i class="fas fa-chart-bar" style="color: #F2C811;"></i><span>Power BI</span>
                </div>
                <div class="palette-item" draggable="true"
                     data-consumption-type="excel" data-name="Excel" data-category="Productivity"
                     data-icon="fas fa-file-excel" data-icon-color="#217346" title="Excel">
                    <i class="fas fa-file-excel" style="color: #217346;"></i><span>Excel</span>
                </div>
                <div class="palette-item" draggable="true"
                     data-consumption-type="sql-endpoint" data-name="SQL Endpoint" data-category="Data Access"
                     data-icon="fas fa-database" data-icon-color="#0078D4" title="SQL Endpoint">
                    <i class="fas fa-database" style="color: #0078D4;"></i><span>SQL Endpoint</span>
                </div>
            </div>

            <!-- Main Workspace - Full Width Canvas -->
            <div class="fabric-main-workspace">
                <!-- Canvas Area - Full Width -->
                <div class="fabric-canvas" id="fabric-canvas">
                    <!-- Background layout (non-interactive) - Single large area -->
                    <div class="canvas-background" aria-hidden="true">
                        <div class="bg-panel bg-prepare">
                            <div class="bg-title">Architecture Canvas</div>
                        </div>
                    </div>

                    <!-- Dynamic items will be added here via JavaScript -->
                </div>

                <!-- Right Panel removed: Consumption items are now in the top palette -->
            </div>

            <!-- Bottom Panel - Architecture Insights -->
            <div class="fabric-insights-panel">
                <h3><i class="fas fa-lightbulb"></i> Architecture Insights</h3>
                <div class="insights-grid" id="architecture-insights">
                    <div class="insight-item">
                        <i class="fas fa-info-circle"></i>
                        <span>Start by adding data sources to map your architecture</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Database Selection Modal -->
    <div class="database-modal" id="database-modal" style="display: none;">
        <div class="database-modal-content">
            <div class="database-modal-header">
                <h3><i class="fas fa-database"></i> Select Databases to Add</h3>
                <button class="database-modal-close" id="database-modal-close">&times;</button>
            </div>
            <div class="database-modal-body">
                <div class="database-grid" id="database-grid">
                    <!-- Database options will be loaded dynamically -->
                </div>
            </div>
            <div class="database-modal-footer">
                <button class="btn btn-secondary" id="select-all-btn">Select All</button>
                <button class="btn btn-secondary" id="clear-all-btn">Clear All</button>
                <button class="btn btn-primary" id="add-selected-btn">Add Selected</button>
            </div>
        </div>
    </div>

    <script src="playground.js"></script>
</body>
</html>
